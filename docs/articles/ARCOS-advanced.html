<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced usage of ARCOS • ARCOS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Advanced usage of ARCOS">
<meta property="og:description" content="ARCOS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ARCOS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ARCOS-advanced.html">Advanced usage of ARCOS</a>
    </li>
    <li>
      <a href="../articles/ARCOS-basics.html">Basic usage of ARCOS</a>
    </li>
    <li>
      <a href="../articles/ARCOS-synth2D.html">ARCOS detect from images</a>
    </li>
    <li>
      <a href="../articles/ARCOS-tests.html">ARCOS demo of synthetic test</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ARCOS-advanced_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Advanced usage of ARCOS</h1>
            
      
      
      <div class="hidden name"><code>ARCOS-advanced.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ARCOS</span><span class="op">)</span>
<span class="co">#&gt; Warning: replacing previous import 'data.table::melt' by 'reshape2::melt' when</span>
<span class="co">#&gt; loading 'ARCOS'</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>At its core, the tracking algorithm starts with spatial clustering in the first frame with objects using <code>dbscan</code> algorithm. Objects from subsequent frames are added to existing clusters based on their threshold distance. Objects that cannot be added to any of the existing clusters are again spatially clustered and form potential <em>seeds</em> of new clusters. The entire procedure is repeated.</p>
<p>The application of this clustering procedure to collective activation events in biological systems requires identification of <em>active</em> objects, i.e. objects that will be passed to the clustering algorithm. In practice the single-cell activity over time needs to be thresholded and binarised. ARCOS offers several approaches to perform such approaches that will be covered below.</p>
</div>
<div id="basic-example" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-example" class="anchor"></a>Basic example</h1>
<p>In this example 4 distinct objects are moving in 1 dimension over 5 time points. We aim to identify clusters of objects moving close to each other.</p>
<div id="time-sequence" class="section level2">
<h2 class="hasAnchor">
<a href="#time-sequence" class="anchor"></a>Time sequence</h2>
<p>The minimal data in the long format consists of 3 columns:</p>
<ul>
<li>
<code>frame</code> with the frame number that corresponds to the time point,</li>
<li>
<code>objid</code> with the unique identifier of every object,</li>
<li>
<code>x</code> with the position of the object.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dts</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,
                 objid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,
                 x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1.2</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">0.9</span>, <span class="fl">2.6</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>, <span class="fl">1.1</span>, <span class="fl">2.8</span>, <span class="fl">3.1</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">dts</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">frame</th>
<th align="right">objid</th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2.5</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">3.5</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2.6</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">3</td>
<td align="right">2.9</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">3.2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1.1</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2.8</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">4</td>
<td align="right">3.1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">4</td>
<td align="right">3.0</td>
</tr>
</tbody>
</table>
<p>Initiate an <code>arcosTS</code> object. Specify the names of frame, object id, and positions columns. The function simply adds attributes to the existing data.table object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ARCOS</span><span class="op">)</span>

<span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/arcosTS.html">arcosTS</a></span><span class="op">(</span>dt <span class="op">=</span> <span class="va">dts</span>, 
               colPos <span class="op">=</span> <span class="st">"x"</span>, 
               col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Frame <span class="op">=</span> <span class="st">"frame"</span>, 
                          RT <span class="op">=</span> <span class="cn">NULL</span>, 
                          IDobj <span class="op">=</span> <span class="st">"objid"</span>, 
                          IDcoll <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>, 
               interVal <span class="op">=</span> <span class="fl">1</span>, 
               interType <span class="op">=</span> <span class="st">"f"</span><span class="op">)</span></code></pre></div>
<p>Plot the time series. Each object has a distinct identifier represented by a different colour in the plot:</p>
<p><img src="ARCOS-advanced_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
</div>
<div id="detection-and-tracking" class="section level2">
<h2 class="hasAnchor">
<a href="#detection-and-tracking" class="anchor"></a>Detection and tracking</h2>
<p>In this step 3 objects on the top are grouped into a single collective event that spans 5 frames. A single object on the bottom forms a single-object event.</p>
<p>The most important parameter of the <code>trackColl</code> function is the search radius <code>eps</code>, which sets the distance for:</p>
<ul>
<li>the <code>dbscan</code> spatial clustering in a single time frame,</li>
<li>possible objects that can be part of collective events identified in previous frame(s).</li>
</ul>
<p>The minimum size of the spatial cluster is set using the <code>minClSz</code> parameter, which is also passed to <code>dbscan</code>. The parameter <code>nPrev</code> determines the number of previous frames that are searched for collective events in order to match them to objects in the current frame.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dcoll</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackColl.html">trackColl</a></span><span class="op">(</span><span class="va">dts</span><span class="op">)</span></code></pre></div>
<p>The output contains 3 columns with the frame number, object identifier, and the calculated identifier of the collective event:</p>
<table class="table">
<thead><tr class="header">
<th align="right">frame</th>
<th align="right">objid</th>
<th align="right">collid.frame</th>
<th align="right">collid</th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2.5</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">3.5</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">2.6</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">2.9</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">3.2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">1.1</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">2.8</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">4</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">3.1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">9</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">4</td>
<td align="right">10</td>
<td align="right">2</td>
<td align="right">3.0</td>
</tr>
</tbody>
</table>
</div>
<div id="visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#visualisation" class="anchor"></a>Visualisation</h2>
<p>Plot:</p>
<p>Each trace is assigned an identifier of the collective event, which is represented by the shape of the point in the plot:</p>
<p><img src="ARCOS-advanced_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
<p>The algorithm with the default search radius <code>eps=1.0</code> has identified two collective events. One is an event with only a single object, the latter is an event that consists of 1 to 3 objects at different points in time.</p>
</div>
</div>
<div id="single-cell-dynamics" class="section level1">
<h1 class="hasAnchor">
<a href="#single-cell-dynamics" class="anchor"></a>Single-cell dynamics</h1>
<p>TODO</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Maciej Dobrzyński.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

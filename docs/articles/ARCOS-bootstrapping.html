<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Collective events in synthetic data with bootstrapping • ARCOS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Collective events in synthetic data with bootstrapping">
<meta property="og:description" content="ARCOS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ARCOS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ARCOS-basics.html">Basic usage of ARCOS</a>
    </li>
    <li>
      <a href="../articles/ARCOS-binTimeseries.html">Pre-processing time-series for ARCOS</a>
    </li>
    <li>
      <a href="../articles/ARCOS-bootstrapping.html">Collective events in synthetic data with bootstrapping</a>
    </li>
    <li>
      <a href="../articles/ARCOS-synthRand2D.html">Detect synthetic random collective events</a>
    </li>
    <li>
      <a href="../articles/ARCOS-synthRasterImages.html">Detect collective events from images</a>
    </li>
    <li>
      <a href="../articles/ARCOS-unitTests.html">ARCOS demo of unit tests</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Collective events in synthetic data with
bootstrapping</h1>
            
      
      
      <div class="hidden name"><code>ARCOS-bootstrapping.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>This notebook demonstrates how to calculate p-values of collective
events statistics using bootstrapping. The dataset used in this example
was generated with <a href="http://www.netlogoweb.org" class="external-link">NetLogo</a>
agent-based simulation that models collective activation events in a 2D
epithelium. In the model, 2500 cells were placed on a 50x50 hexagonal
grid. Collective events appear sparsely in the epithelium, they
propagate radially from a source cell up to 3 cell rows. There is a 15%
failure for a cell to propagate the wave, therefore the events are not
always perfectly symmetrical. The simulation lasts 200 iterations.</p>
<p>Collective events are identified with ARCOS. To calculate the
p-value, 5 different bootstrapping methods are applied:</p>
<ul>
<li>shuffling entire single-cell tracks in space,</li>
<li>randomly shifting entire single-cell tracks back or forth in
time,</li>
<li>shuffling time points independently for each track,</li>
<li>shuffling the measurement between space independently for each time
frame,</li>
<li>shuffling activity blocks independently for each track.</li>
</ul>
</div>
<div class="section level2">
<h2 id="set-the-parameters">Set the parameters<a class="anchor" aria-label="anchor" href="#set-the-parameters"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ARCOS</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes" class="external-link">ggthemes</a></span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Definitions</span></span>
<span></span>
<span><span class="va">lPar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">fIn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'synthetic2D/Gradient20.csv.gz'</span>,</span>
<span>                       package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">fov</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">'Gradient([0-9]+).*'</span>, <span class="st">'\\1'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">fIn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: NAs introduced by coercion</span></span>
<span></span>
<span><span class="co"># measurement</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">sample.period</span> <span class="op">=</span> <span class="fl">1L</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">pxscale</span> <span class="op">=</span> <span class="fl">1</span> <span class="co">#um/px</span></span>
<span></span>
<span><span class="co"># params for dbscan</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span> <span class="op">=</span> <span class="fl">1.5</span> <span class="co"># neighbourhood size; units of pixels</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span> <span class="op">=</span> <span class="fl">3L</span> <span class="co"># minimum number of cells in a cluster</span></span>
<span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">trackLinkFrames</span> <span class="op">=</span> <span class="fl">1L</span> <span class="co"># no. of subsequent frames to link during tracking; units of frames</span></span>
<span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span> <span class="op">=</span> <span class="fl">2L</span> <span class="co"># minimum duration of collective events</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span> <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span> <span class="co"># minimum total size of collective events</span></span>
<span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">debug</span> <span class="op">=</span> <span class="cn">T</span></span>
<span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span> <span class="op">=</span> <span class="fl">2L</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span> <span class="op">=</span> <span class="fl">1000L</span></span>
<span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">limxy</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">limt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lCols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lCols</span><span class="op">$</span><span class="va">frame</span> <span class="op">=</span> <span class="st">"ticks"</span></span>
<span><span class="va">lCols</span><span class="op">$</span><span class="va">posx</span> <span class="op">=</span> <span class="st">"xcor"</span></span>
<span><span class="va">lCols</span><span class="op">$</span><span class="va">posy</span> <span class="op">=</span> <span class="st">"ycor"</span></span>
<span><span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span> <span class="op">=</span> <span class="st">"who"</span></span>
<span><span class="va">lCols</span><span class="op">$</span><span class="va">meas</span> <span class="op">=</span> <span class="st">"meas"</span></span>
<span><span class="va">lCols</span><span class="op">$</span><span class="va">measbin</span> <span class="op">=</span> <span class="st">"meas.bin"</span></span>
<span><span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span> <span class="op">=</span> <span class="st">"collid"</span></span></code></pre></div>
<p>Data: acquisition period: 1.00 [minutes]</p>
<p>ARCOS: neighbourhood size for dbscan: 1.50 [px]</p>
<p>ARCOS: minimum cluster size for dbscan: 3 [cells]</p>
<p>ARCOS: number of subsequent frames to link: 1 [frames]</p>
<p>ARCOS: minimum duration of collective events: 2 [frames]</p>
<p>ARCOS: minimum total size of collective events: 3 [cells]</p>
<p>ARCOS: number of bootstrapping iterations: 1000</p>
</div>
<div class="section level2">
<h2 id="read-data">Read data<a class="anchor" aria-label="anchor" href="#read-data"></a>
</h2>
<p>Reading a CSV file from the NetLogo simulation output.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read data</span></span>
<span><span class="va">ts</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">fIn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorderv</a></span><span class="op">(</span><span class="va">ts</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>, <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html" class="external-link">setnames</a></span><span class="op">(</span><span class="va">ts</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ERKactivityValue'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'meas'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create an ARCOS ts object</span></span>
<span><span class="va">ts</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/arcosTS.html">arcosTS</a></span><span class="op">(</span><span class="va">ts</span>, </span>
<span>                    colPos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">posx</span>, <span class="va">lCols</span><span class="op">$</span><span class="va">posy</span><span class="op">)</span>, </span>
<span>                    colMeas <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">meas</span>,</span>
<span>                    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Frame <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>, </span>
<span>                               IDobj <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span><span class="op">)</span>, </span>
<span>                    interVal <span class="op">=</span> <span class="fl">1L</span>, </span>
<span>                    interType <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="identify-activity">Identify activity<a class="anchor" aria-label="anchor" href="#identify-activity"></a>
</h2>
<p>Here we identify activity pulses in single cells by using a simple
thresholding method.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># binarise the measurement</span></span>
<span><span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/binMeas.html">binMeas</a></span><span class="op">(</span><span class="va">ts</span>,</span>
<span>               biasMet <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>               binThr <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the results of activity detection for a sample of long tracks</span></span>
<span><span class="va">vLongTracks</span> <span class="op">=</span> <span class="va">ts</span><span class="op">[</span>,</span>
<span>                 <span class="fu">.</span><span class="op">(</span>trackLen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span><span class="op">)</span><span class="op">]</span><span class="op">[[</span><span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">tsPlot</span> <span class="op">=</span> <span class="va">ts</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">vLongTracks</span><span class="op">]</span></span>
<span></span>
<span><span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/plotBinMeas.html">plotBinMeas</a></span><span class="op">(</span><span class="va">tsPlot</span>, </span>
<span>                   ntraj <span class="op">=</span> <span class="fl">25</span>, </span>
<span>                   inSeed <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                   measfac <span class="op">=</span> <span class="fl">1.</span>,</span>
<span>                   xfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">sample.period</span>, </span>
<span>                   plotResc <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html" class="external-link">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"ERK activity"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 273 rows containing missing values (`geom_path()`).</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/idActivePlot-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="ces---non-bootstrapped">CEs - non-bootstrapped<a class="anchor" aria-label="anchor" href="#ces---non-bootstrapped"></a>
</h2>
<p>Identify collective events in the original data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform tracking of collective events.</span></span>
<span><span class="co"># Pass single-cell data that has a binarised measurement greater than 1.</span></span>
<span><span class="va">tcoll</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackColl.html">trackColl</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">measbin</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, </span>
<span>                         eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                         minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter collective events based on size and duration</span></span>
<span><span class="va">tcollsel</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/selColl.html">selColl</a></span><span class="op">(</span><span class="va">tcoll</span>,</span>
<span>                          colldur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                          colltotsz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tsWithColl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">ts</span>, </span>
<span>                   <span class="va">tcollsel</span><span class="op">[</span>, </span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>, </span>
<span>                              <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span>, </span>
<span>                              <span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span><span class="op">)</span>, </span>
<span>                            with <span class="op">=</span> <span class="cn">F</span><span class="op">]</span>, </span>
<span>                   by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>, </span>
<span>                          <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span><span class="op">)</span>, </span>
<span>                   all.x <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="cluster-properties">Cluster properties<a class="anchor" aria-label="anchor" href="#cluster-properties"></a>
</h3>
<p>We extract two statistics of collective events: event duration and
the total event size.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate duration of collective events in frames</span></span>
<span><span class="va">tcollselAggr</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/calcStatsColl.html">calcStatsColl</a></span><span class="op">(</span><span class="va">tcollsel</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">pClProp</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollselAggr</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>                     y <span class="op">=</span> <span class="va">clDur</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html" class="external-link">geom_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                              trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pClProp</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/propColl-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="noodle-plot">Noodle plot<a class="anchor" aria-label="anchor" href="#noodle-plot"></a>
</h3>
<p>X/T projection of individual cells in collective events. Tracks
coloured by the id of collective events.</p>
<p><img src="ARCOS-bootstrapping_files/figure-html/noodleColl-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="ces---bootstraped">CEs - bootstraped<a class="anchor" aria-label="anchor" href="#ces---bootstraped"></a>
</h2>
<p>Calculate p-values for the two statistics (duration and size) using
bootstrapping. Each calculation can take up to several minutes!</p>
<div class="section level3">
<h3 id="randomise-initial-xy">Randomise initial XY<a class="anchor" aria-label="anchor" href="#randomise-initial-xy"></a>
</h3>
<p>In this approach, the initial position of every track is shuffled
between all cells in the system. Since the measurement dynamics remains
intact, this approach randomises only the spatial aspect of collective
phenomena, i.e. tracks are only rearranged in space while retaining
their measurement dynamics. One caveat concerns cases where
cells/objects are moving in space. By assigning new starting points,
objects’ positions may exceed the initial bounds of the field of
view.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform bootstrap</span></span>
<span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_randInitXY_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu">calcBoot</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                       nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                       ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>,</span>
<span>                       method <span class="op">=</span> <span class="st">'shuffCoord'</span>, deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Aggregate the results of bootstrapping</span></span>
<span><span class="va">dtBootResAggr</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                          by <span class="op">=</span> <span class="va">iter</span>,</span>
<span>                          .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dtBootResN</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                       <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">collid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       by <span class="op">=</span> <span class="va">iter</span><span class="op">]</span></span></code></pre></div>
<p>Sample noodle plot from bootstrapped data:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nTry</span> <span class="op">=</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">nTry</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tsRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/shuffCoord.html">shuffCoord</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span>  <span class="va">stmp</span> <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">measbin</span></span>
<span>  </span>
<span>  <span class="va">tcollRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackColl.html">trackColl</a></span><span class="op">(</span><span class="va">tsRand</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, </span>
<span>                               eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                               minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span><span class="op">)</span></span>
<span>  <span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/selColl.html">selColl</a></span><span class="op">(</span><span class="va">tcollRand</span>, </span>
<span>                                colldur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                colltotsz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">nTry</span> <span class="op">=</span> <span class="va">nTry</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">p101</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/plotNoodle2D.html">plotNoodle2D</a></span><span class="op">(</span><span class="va">tcollselRand</span>, </span>
<span>                             xfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">sample.period</span>,</span>
<span>                             yfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">pxscale</span>,</span>
<span>                             pos <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                             tfreq <span class="op">=</span> <span class="fl">1</span>, style <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limt</span>, ylim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limxy</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Position X [um]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p101</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'No collective events found in 10 randomised bootstrap iterations'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Distribution of the number of collective events identified in every
bootstrap iteration:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dtBootResN</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `after_stat(density)` instead.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/randIniXYbootVSorigNevents-1.png" width="700"></p>
<p>P-value, alternative hypothesis - the number of clusters from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">dtBootResN</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean cluster duration from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean total cluster size from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="randomly-shift-the-measurement">Randomly shift the measurement<a class="anchor" aria-label="anchor" href="#randomly-shift-the-measurement"></a>
</h3>
<p>Here, entire single-cell tracks are shifted forward or backward in
time. The spatial arrangement of cells and the measurement dynamics are
intact, except activation events occur at different times than
originally.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_randShiftMeas_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu">calcBoot</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                       nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                       ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>,</span>
<span>                       method <span class="op">=</span> <span class="st">'randShiftMeas'</span>, deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Aggregate the results of bootstrapping</span></span>
<span><span class="va">dtBootResAggr</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                          by <span class="op">=</span> <span class="va">iter</span>,</span>
<span>                          .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dtBootResN</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                       <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">collid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       by <span class="op">=</span> <span class="va">iter</span><span class="op">]</span></span></code></pre></div>
<p>Sample noodle plot from bootstrapped data:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nTry</span> <span class="op">=</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">nTry</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tsRand</span> <span class="op">=</span> <span class="fu"><a href="../reference/randShiftMeas.html">randShiftMeas</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span>  <span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">measbin</span>, <span class="st">'.shuff'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tcollRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackColl.html">trackColl</a></span><span class="op">(</span><span class="va">tsRand</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, </span>
<span>                               eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                               minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span><span class="op">)</span></span>
<span>  <span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/selColl.html">selColl</a></span><span class="op">(</span><span class="va">tcollRand</span>, </span>
<span>                                colldur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                colltotsz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">nTry</span> <span class="op">=</span> <span class="va">nTry</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">p201</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/plotNoodle2D.html">plotNoodle2D</a></span><span class="op">(</span><span class="va">tcollselRand</span>, </span>
<span>                        xfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">sample.period</span>,</span>
<span>                        yfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">pxscale</span>,</span>
<span>                        pos <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        tfreq <span class="op">=</span> <span class="fl">1</span>, style <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limt</span>, ylim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limxy</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Position X [um]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p201</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'No collective events found in 10 randomised bootstrap iterations'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Distribution of the number of collective events identified in every
bootstrap iteration:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dtBootResN</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/randShiftMeasBootVSorigNevents-1.png" width="700"></p>
<p>P-value, alternative hypothesis - the number of clusters from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">dtBootResN</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean cluster duration from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean total cluster size from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shuffle-time-points-per-track">Shuffle time points per track<a class="anchor" aria-label="anchor" href="#shuffle-time-points-per-track"></a>
</h3>
<p>Here, individual time points are shuffled independetly in each track.
While the spatial arrangement is intact, the measurement dynamics is
completely randomised.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_shuffMeasTrack_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu">calcBoot</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                       nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                       ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>,</span>
<span>                       method <span class="op">=</span> <span class="st">'shuffMeasTrack'</span>, deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Aggregate the results of bootstrapping</span></span>
<span><span class="va">dtBootResAggr</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                          by <span class="op">=</span> <span class="va">iter</span>,</span>
<span>                          .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dtBootResN</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                       <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">collid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       by <span class="op">=</span> <span class="va">iter</span><span class="op">]</span></span></code></pre></div>
<p>Sample noodle plot from bootstrapped data:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nTry</span> <span class="op">=</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">nTry</span> <span class="op">&lt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tsRand</span> <span class="op">=</span> <span class="fu"><a href="../reference/shuffMeasTrack.html">shuffMeasTrack</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span>  <span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">measbin</span>, <span class="st">'.shuff'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tcollRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackColl.html">trackColl</a></span><span class="op">(</span><span class="va">tsRand</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, </span>
<span>                               eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                               minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span><span class="op">)</span></span>
<span>  <span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/selColl.html">selColl</a></span><span class="op">(</span><span class="va">tcollRand</span>, </span>
<span>                                colldur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                colltotsz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">nTry</span> <span class="op">=</span> <span class="va">nTry</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">p301</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/plotNoodle2D.html">plotNoodle2D</a></span><span class="op">(</span><span class="va">tcollselRand</span>, </span>
<span>                        xfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">sample.period</span>,</span>
<span>                        yfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">pxscale</span>,</span>
<span>                        pos <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        tfreq <span class="op">=</span> <span class="fl">1</span>, style <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limt</span>, ylim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limxy</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Position X [um]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p301</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'No collective events found in 10 randomised bootstrap iterations'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>P-value, alternative hypothesis - the number of clusters from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">dtBootResN</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the number of collective events identified in every
bootstrap iteration:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dtBootResN</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/shuffMeasTrackBootVSorigNevents-1.png" width="700"></p>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean cluster duration from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean total cluster size from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shuffle-measurement-per-frame">Shuffle measurement per frame<a class="anchor" aria-label="anchor" href="#shuffle-measurement-per-frame"></a>
</h3>
<p>Here, binarised measurements are shuffled between cells independently
in every time frame.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_shuffMeasFrame_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu">calcBoot</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                       nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                       ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>,</span>
<span>                       method <span class="op">=</span> <span class="st">'shuffMeasFrame'</span>, deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dtBootResAggr</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                          by <span class="op">=</span> <span class="va">iter</span>,</span>
<span>                          .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dtBootResN</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                       <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">collid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       by <span class="op">=</span> <span class="va">iter</span><span class="op">]</span></span></code></pre></div>
<p>Sample noodle plot from bootstrapped data:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nTry</span> <span class="op">=</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">nTry</span> <span class="op">&lt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tsRand</span> <span class="op">=</span> <span class="fu"><a href="../reference/shuffMeasFrame.html">shuffMeasFrame</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span>  <span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">measbin</span>, <span class="st">'.shuff'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tcollRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackColl.html">trackColl</a></span><span class="op">(</span><span class="va">tsRand</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, </span>
<span>                               eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                               minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span><span class="op">)</span></span>
<span>  <span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/selColl.html">selColl</a></span><span class="op">(</span><span class="va">tcollRand</span>, </span>
<span>                                colldur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                colltotsz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">nTry</span> <span class="op">=</span> <span class="va">nTry</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">p401</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/plotNoodle2D.html">plotNoodle2D</a></span><span class="op">(</span><span class="va">tcollselRand</span>, </span>
<span>                        xfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">sample.period</span>,</span>
<span>                        yfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">pxscale</span>,</span>
<span>                        pos <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        tfreq <span class="op">=</span> <span class="fl">1</span>, style <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limt</span>, ylim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limxy</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Position X [um]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p401</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'No collective events found in 10 randomised bootstrap iterations'</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; `geom_path()`: Each group consists of only one observation.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Do you need to adjust the <span style="color: #00BB00;">group</span> aesthetic?</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Distribution of the number of collective events identified in every
bootstrap iteration:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dtBootResN</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/shuffMeasFrameBootVSorigNevents-1.png" width="700"></p>
<p>P-value, alternative hypothesis - the number of clusters from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">dtBootResN</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean cluster duration from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean total cluster size from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shuffle-blocks-per-track">Shuffle blocks per track<a class="anchor" aria-label="anchor" href="#shuffle-blocks-per-track"></a>
</h3>
<p>In this approach, blocks of activity in binarised time series are
shuffled independently in every track.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_shuffBlockTrack_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">dtBootRes</span> <span class="op">=</span> <span class="fu">calcBoot</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                       nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                       ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>, </span>
<span>                       method <span class="op">=</span> <span class="st">'shuffBlockTrack'</span>, deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Aggregate the results of bootstrapping</span></span>
<span><span class="va">dtBootResAggr</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                          by <span class="op">=</span> <span class="va">iter</span>,</span>
<span>                          .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dtBootResN</span> <span class="op">=</span> <span class="va">dtBootRes</span><span class="op">[</span>,</span>
<span>                       <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">collid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       by <span class="op">=</span> <span class="va">iter</span><span class="op">]</span></span></code></pre></div>
<p>Sample noodle plot from bootstrapped data:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nTry</span> <span class="op">=</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">nTry</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tsRand</span> <span class="op">=</span> <span class="fu"><a href="../reference/shuffBlockTrack.html">shuffBlockTrack</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span>  <span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">measbin</span>, <span class="st">'.shuff'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tcollRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackColl.html">trackColl</a></span><span class="op">(</span><span class="va">tsRand</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, </span>
<span>                               eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                               minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span><span class="op">)</span></span>
<span>  <span class="va">tcollselRand</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/selColl.html">selColl</a></span><span class="op">(</span><span class="va">tcollRand</span>, </span>
<span>                                colldur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                colltotsz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">nTry</span> <span class="op">=</span> <span class="va">nTry</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselRand</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">p501</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/plotNoodle2D.html">plotNoodle2D</a></span><span class="op">(</span><span class="va">tcollselRand</span>, </span>
<span>                        xfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">sample.period</span>,</span>
<span>                        yfac <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">pxscale</span>,</span>
<span>                        pos <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        tfreq <span class="op">=</span> <span class="fl">1</span>, style <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limt</span>, ylim <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">limxy</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Position X [um]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p501</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'No collective events found in 10 randomised bootstrap iterations'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>P-value, alternative hypothesis - the number of clusters from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">dtBootResN</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the number of collective events identified in every
bootstrap iteration:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dtBootResN</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/shuffBlockTrackBootVSorigNevents-1.png" width="700"></p>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean cluster duration from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dtBootResAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<p>P-value, alternative hypothesis - mean total cluster size from the
bootstrap is lower or greater than the original:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">dtBootResAggr</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001998002</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maciej Dobrzyński.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Collective events in synthetic data with bootstrapping • ARCOS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Collective events in synthetic data with bootstrapping">
<meta property="og:description" content="ARCOS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ARCOS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ARCOS-basics.html">Basic usage of ARCOS</a>
    </li>
    <li>
      <a href="../articles/ARCOS-binTimeseries.html">Pre-processing time-series for ARCOS</a>
    </li>
    <li>
      <a href="../articles/ARCOS-bootstrapping.html">Collective events in synthetic data with bootstrapping</a>
    </li>
    <li>
      <a href="../articles/ARCOS-synthRand2D.html">Detect synthetic random collective events</a>
    </li>
    <li>
      <a href="../articles/ARCOS-synthRasterImages.html">Detect collective events from images</a>
    </li>
    <li>
      <a href="../articles/ARCOS-unitTests.html">ARCOS demo of unit tests</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dmattek/ARCOS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Collective events in synthetic data with
bootstrapping</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dmattek/ARCOS/blob/HEAD/vignettes/ARCOS-bootstrapping.Rmd" class="external-link"><code>vignettes/ARCOS-bootstrapping.Rmd</code></a></small>
      <div class="hidden name"><code>ARCOS-bootstrapping.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>This notebook demonstrates how to calculate p-values of collective
events statistics using bootstrapping. The dataset used in this example
was generated with <a href="http://www.netlogoweb.org" class="external-link">NetLogo</a>
agent-based simulation that models collective activation events in a 2D
epithelium. In the model, 2500 cells were placed on a 50x50 hexagonal
grid. Collective events appear sparsely in the epithelium, they
propagate radially from a source cell up to 3 cell rows. There is a 15%
failure for a cell to propagate the wave, therefore the events are not
always perfectly symmetrical. The simulation lasts 200 iterations.</p>
<p>Collective events are identified with ARCOS. To calculate the
p-value, 5 different bootstrapping methods are applied:</p>
<ul>
<li>shuffling entire single-cell tracks in space,</li>
<li>randomly shifting entire single-cell tracks back or forth in
time,</li>
<li>shuffling time points independently for each track,</li>
<li>shuffling the measurement between space independently for each time
frame,</li>
<li>shuffling activity blocks independently for each track.</li>
</ul>
</div>
<div class="section level2">
<h2 id="set-the-parameters">Set the parameters<a class="anchor" aria-label="anchor" href="#set-the-parameters"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmattek/ARCOS" class="external-link">ARCOS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes" class="external-link">ggthemes</a></span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Definitions</span></span>
<span></span>
<span><span class="va">lPar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">fIn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'synthetic2D/Gradient20.csv.gz'</span>,</span>
<span>                       package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters for tracking collective events</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span> <span class="op">=</span> <span class="fl">1.5</span> <span class="co"># neighbourhood size; units of pixels</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span> <span class="op">=</span> <span class="fl">3L</span> <span class="co"># minimum number of cells in a cluster</span></span>
<span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">trackLinkFrames</span> <span class="op">=</span> <span class="fl">1L</span> <span class="co"># no. of subsequent frames to link during tracking; units of frames</span></span>
<span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span> <span class="op">=</span> <span class="fl">2L</span> <span class="co"># minimum duration of collective events</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span> <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span> <span class="co"># minimum total size of collective events</span></span>
<span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">debug</span> <span class="op">=</span> <span class="cn">T</span></span>
<span></span>
<span><span class="co"># Parameters for bootstrapping</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span> <span class="op">=</span> <span class="fl">2L</span> <span class="co"># number of parallel cores</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span> <span class="op">=</span> <span class="fl">100L</span> <span class="co"># number of bootstrapping iterations</span></span>
<span></span>
<span><span class="co"># Dataset limits for plotting</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">limxy</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">limt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">220</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True size and duration of a single synthetic event</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">sim.cltotsz</span> <span class="op">=</span> <span class="fl">37</span></span>
<span><span class="va">lPar</span><span class="op">$</span><span class="va">sim.cldur</span> <span class="op">=</span> <span class="fl">9</span></span>
<span></span>
<span><span class="co"># True maximum diameter evolution of a single event in time</span></span>
<span><span class="va">ttrueDiam</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>tevent <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">8</span>,</span>
<span>                       diam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.236068</span>, <span class="fl">4.472136</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6.708204</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Column names</span></span>
<span><span class="va">lCols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="st">'frame'</span>,</span>
<span>             posx <span class="op">=</span> <span class="st">'x'</span>,</span>
<span>             posy <span class="op">=</span> <span class="st">'y'</span>,</span>
<span>             trackid <span class="op">=</span> <span class="st">'id'</span>,</span>
<span>             meas <span class="op">=</span> <span class="st">'meas'</span>,</span>
<span>             measresc <span class="op">=</span> <span class="st">'meas.resc'</span>,</span>
<span>             measbin <span class="op">=</span> <span class="st">'meas.bin'</span>,</span>
<span>             cltrackid <span class="op">=</span> <span class="st">'collid'</span>,</span>
<span>             bootiter <span class="op">=</span> <span class="st">'bootiter'</span><span class="op">)</span></span></code></pre></div>
<p>Neighbourhood size for dbscan: 1.50 [px]</p>
<p>Minimum cluster size for dbscan: 3 [cells]</p>
<p>Number of subsequent frames to link: 1 [frames]</p>
<p>Minimum duration of collective events: 2 [frames]</p>
<p>Minimum total size of collective events: 3 [cells]</p>
<p>Number of bootstrapping iterations: 100</p>
</div>
<div class="section level2">
<h2 id="read-data">Read data<a class="anchor" aria-label="anchor" href="#read-data"></a>
</h2>
<p>Read a compressed CSV file, <code>Gradient20.csv.gz</code> from the
NetLogo simulation output. The dataset is included with the ARCOS
package. The function <code>loadDataFromFile</code> is a wrapper for
<code><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">data.table::fread</a></code>. It reads the file and sets the
attributes of the ARCOS object according to parameters defined
above.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read data</span></span>
<span><span class="va">ts</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/loadDataFromFile.html">loadDataFromFile</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">fIn</span>,</span>
<span>                             colPos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">posx</span>, <span class="va">lCols</span><span class="op">$</span><span class="va">posy</span><span class="op">)</span>, </span>
<span>                             colMeas <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">meas</span>,</span>
<span>                             colFrame <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>, </span>
<span>                             colIDobj <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span><span class="op">)</span></span></code></pre></div>
<p>The dataset is in long format where each row corresponds to the
measurement and position of a single object/cell at a particular point
in time:</p>
<table class="table">
<thead><tr class="header">
<th align="right">frame</th>
<th align="right">id</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">startCE</th>
<th align="right">meas</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-12</td>
<td align="right">-4.5</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">1</td>
<td align="right">19</td>
<td align="right">19.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">2</td>
<td align="right">-15</td>
<td align="right">4.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="right">-17.5</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">-15.5</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">5</td>
<td align="right">23</td>
<td align="right">25.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The columns have the following data:</p>
<ul>
<li>
<code>frame</code>, time frames,</li>
<li>
<code>id</code>, object/cell IDs,</li>
<li>
<code>x</code> and <code>y</code>, object coordinates,</li>
<li>
<code>startCE</code>, an indication of when a collective event is
initiated in the simulation,</li>
<li>
<code>meas</code>, the measurement.</li>
</ul>
</div>
<div class="section level2">
<h2 id="identify-activity">Identify activity<a class="anchor" aria-label="anchor" href="#identify-activity"></a>
</h2>
<p>Here we identify activity pulses in single cells by using a simple
thresholding method, i.e. all measurements above 0 are considered
<em>active</em>. The function <code>binMeas</code> adds two new columns
to the dataset, <code>meas.resc</code> and <code>meas.bin</code> with
rescaled and binarised measurements, respectively.</p>
<p>The parameter <code>smoothK=1</code> indicates that the smoothing
window initially applied to the time series is a single time point, thus
no smoothing is performed. The result of thresholding is equivalent to
calculating <code>meas &gt; 0</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># binarise the measurement</span></span>
<span><span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/binMeas.html">binMeas</a></span><span class="op">(</span><span class="va">ts</span>,</span>
<span>               biasMet <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>               smoothK <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               binThr <span class="op">=</span> <span class="fl">0.</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">frame</th>
<th align="right">id</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">startCE</th>
<th align="right">meas</th>
<th align="right">meas.resc</th>
<th align="right">meas.bin</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-12</td>
<td align="right">-4.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">-12</td>
<td align="right">-4.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0</td>
<td align="right">-12</td>
<td align="right">-4.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">0</td>
<td align="right">-12</td>
<td align="right">-4.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">0</td>
<td align="right">-12</td>
<td align="right">-4.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">0</td>
<td align="right">-12</td>
<td align="right">-4.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The results of activity detection for a sample of long tracks:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/plotBinMeas.html">plotBinMeas</a></span><span class="op">(</span><span class="va">ts</span>, </span>
<span>                   ntraj <span class="op">=</span> <span class="fl">25</span>, </span>
<span>                   inSeed <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                   measfac <span class="op">=</span> <span class="fl">1.</span>,</span>
<span>                   xfac <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                   plotResc <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html" class="external-link">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"ERK activity"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 570 rows containing missing values (`geom_path()`).</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/idActivePlot-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="ces---non-bootstrapped">CEs - non-bootstrapped<a class="anchor" aria-label="anchor" href="#ces---non-bootstrapped"></a>
</h2>
<p>Identify collective events in the original data only for
<em>active</em> cells, which in our case are cells with the measurement
above 0.</p>
<p>The function <code>trackColl</code> returns a data table in long
format only with objects/cells that participate in collective events.
Two additional columns are added, <code>collid.frame</code> and
<code>collid</code>, with IDs of collective events per frame and a
globally unique ID, respectively. The latter, <code>collid</code> is
what we will use in further analysis.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform tracking of collective events.</span></span>
<span><span class="co"># Pass single-cell data that has a binarised measurement greater than 1.</span></span>
<span><span class="va">tcoll</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackColl.html">trackColl</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">measbin</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, </span>
<span>                         eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                         minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter collective events based on size and duration</span></span>
<span><span class="va">tcollsel</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/selColl.html">selColl</a></span><span class="op">(</span><span class="va">tcoll</span>,</span>
<span>                          colldur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                          colltotsz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="8%">
<col width="7%">
<col width="18%">
<col width="9%">
<col width="4%">
<col width="7%">
<col width="11%">
<col width="7%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="right">frame</th>
<th align="right">id</th>
<th align="right">collid.frame</th>
<th align="right">collid</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">startCE</th>
<th align="right">meas</th>
<th align="right">meas.resc</th>
<th align="right">meas.bin</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">489</td>
<td align="right">562</td>
<td align="right">1</td>
<td align="right">9</td>
<td align="right">10.0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1150</td>
<td align="right">562</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">8.5</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1863</td>
<td align="right">562</td>
<td align="right">1</td>
<td align="right">9</td>
<td align="right">9.0</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">1.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2112</td>
<td align="right">562</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="right">8.5</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">2392</td>
<td align="right">562</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9.5</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2427</td>
<td align="right">562</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="right">9.5</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="cluster-properties">Cluster properties<a class="anchor" aria-label="anchor" href="#cluster-properties"></a>
</h3>
<div class="section level4">
<h4 id="ce-growth">CE growth<a class="anchor" aria-label="anchor" href="#ce-growth"></a>
</h4>
<p>Evolution of CEs’ growth quantified by the maximum Feret diameter
(longer side of a minimal oriented bounding box). Red dots indicate the
true evolution of a single synthetic event. Note horizontal shifts to
avoid overplotting!</p>
<p>We observe that the majority of collective events grow as a
prototypical synthetic event with only few events that depart this
dynamics due to overlaps with other events.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the minimal bounding box</span></span>
<span><span class="va">tcollselDiam</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcGrowthColl.html">calcGrowthColl</a></span><span class="op">(</span><span class="va">tcollsel</span><span class="op">)</span></span></code></pre></div>
<p>The function <code>calcGrowthColl</code> adds the width, height and
the time of collective events’ evolution. The longer of the width and
height is taken as the diameter of the event.</p>
<table class="table">
<thead><tr class="header">
<th align="right">frame</th>
<th align="right">collid</th>
<th align="right">w</th>
<th align="right">h</th>
<th align="right">diam</th>
<th align="right">tevent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2.24</td>
<td align="right">1.79</td>
<td align="right">2.24</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">4.47</td>
<td align="right">3.58</td>
<td align="right">4.47</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2.24</td>
<td align="right">1.79</td>
<td align="right">2.24</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">6.71</td>
<td align="right">5.37</td>
<td align="right">6.71</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">4.47</td>
<td align="right">3.58</td>
<td align="right">4.47</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">6.71</td>
<td align="right">5.37</td>
<td align="right">6.71</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollselDiam</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tevent</span>,</span>
<span>           y <span class="op">=</span> <span class="va">diam</span>,</span>
<span>           group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ttrueDiam</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tevent</span>,</span>
<span>                 y <span class="op">=</span> <span class="va">diam</span>,</span>
<span>                 group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Diameter [au]'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
</div>
<div class="section level4">
<h4 id="duration-total-size">Duration &amp; total size<a class="anchor" aria-label="anchor" href="#duration-total-size"></a>
</h4>
<p>We extract two statistics of collective events: event duration and
the total number of unique cells involved in an event (~ size). Dashed
lines indicate true size &amp; duration of synthetic events. Several
bigger and longer-lasting than synthetic events are due to overlap with
other events.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate duration of collective events in frames</span></span>
<span><span class="va">tcollselAggr</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/calcStatsColl.html">calcStatsColl</a></span><span class="op">(</span><span class="va">tcollsel</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollselAggr</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="va">clDur</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html" class="external-link">geom_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                              trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">sim.cltotsz</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">sim.cldur</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/propColl-1.png" width="480"></p>
</div>
</div>
<div class="section level3">
<h3 id="noodle-plot">Noodle plot<a class="anchor" aria-label="anchor" href="#noodle-plot"></a>
</h3>
<p>X/T projection of individual cells that participate in collective
events. Tracks are coloured by the IS of collective events. Red dots
indicate the beginning of a spontaneous collective event in the
simulation.</p>
<p><img src="ARCOS-bootstrapping_files/figure-html/noodleColl-1.png" width="768"></p>
<p>Number of initiated events: 69</p>
<p>Number of detected events: 61</p>
<p>Average binarised activity level: 0.0294</p>
<p>Fraction of activity in (filtered) collective events: 0.9957</p>
</div>
</div>
<div class="section level2">
<h2 id="ces---bootstraped">CEs - bootstraped<a class="anchor" aria-label="anchor" href="#ces---bootstraped"></a>
</h2>
<p>Calculate p-values for the two statistics (duration and size) using
bootstrapping. Each calculation can take up to several minutes!</p>
<div class="section level3">
<h3 id="shuffle-initial-xy">Shuffle initial XY<a class="anchor" aria-label="anchor" href="#shuffle-initial-xy"></a>
</h3>
<p>In this approach, the initial position of every track is shuffled
between all cells in the system. Since the measurement dynamics remains
intact, this approach randomises only the spatial aspect of collective
phenomena, i.e. tracks are only rearranged in space while retaining
their measurement dynamics. One caveat concerns cases where
cells/objects are moving in space. By assigning new starting points,
objects’ positions may exceed the initial bounds of the field of
view.</p>
<p>The <code><a href="../reference/trackCollBoot.html">ARCOS::trackCollBoot</a></code> function outputs a
<code>data.table</code> in long format with time points when individual
objects participate in collective events. From this output, further
statistics can be extracted, such as: duration, size, diameter, number
of collective events. The <code>bootiter</code> column indexes
bootstrapping iterations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform bootstrap or load data from a file</span></span>
<span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_shuffIniXY_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/loadDataFromFile.html">loadDataFromFile</a></span><span class="op">(</span>fname <span class="op">=</span> <span class="va">stmp</span>,</span>
<span>                                         colPos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">posx</span>, <span class="va">lCols</span><span class="op">$</span><span class="va">posy</span><span class="op">)</span>,</span>
<span>                                         colFrame <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>,</span>
<span>                                         colIDobj <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span>,</span>
<span>                                         colIDcoll <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span>,</span>
<span>                                         colBootIter <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span>,</span>
<span>                                         fromColl <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                         fromBoot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackCollBoot.html">trackCollBoot</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                                      nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                                      ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>,</span>
<span>                                      method <span class="op">=</span> <span class="st">'shuffCoord'</span>, </span>
<span>                                      eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      epsPrev <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      nPrev <span class="op">=</span> <span class="fl">1L</span>, </span>
<span>                                      minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span>,</span>
<span>                                      colldurlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                      colltotszlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>                                      deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#fwrite(tcollselBoot, file = sprintf('../inst/synthetic2D/output-bootstrap-20/bootRes_shuffIniXY_N%d.csv.gz', lPar$nboot))</span></span>
<span><span class="op">}</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="6%">
<col width="5%">
<col width="13%">
<col width="7%">
<col width="4%">
<col width="6%">
<col width="8%">
<col width="5%">
<col width="10%">
<col width="9%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="right">bootiter</th>
<th align="right">frame</th>
<th align="right">id</th>
<th align="right">collid.frame</th>
<th align="right">collid</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">startCE</th>
<th align="right">meas</th>
<th align="right">meas.resc</th>
<th align="right">meas.bin</th>
<th align="right">meas.bin.shuff</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">11</td>
<td align="right">120</td>
<td align="right">130</td>
<td align="right">1</td>
<td align="right">-19</td>
<td align="right">-11.0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">11</td>
<td align="right">145</td>
<td align="right">130</td>
<td align="right">1</td>
<td align="right">-18</td>
<td align="right">-9.5</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">11</td>
<td align="right">186</td>
<td align="right">129</td>
<td align="right">2</td>
<td align="right">-18</td>
<td align="right">-13.5</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">1.0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">11</td>
<td align="right">288</td>
<td align="right">130</td>
<td align="right">1</td>
<td align="right">-18</td>
<td align="right">-10.5</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0.8</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">11</td>
<td align="right">723</td>
<td align="right">130</td>
<td align="right">1</td>
<td align="right">-17</td>
<td align="right">-11.0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">11</td>
<td align="right">1734</td>
<td align="right">129</td>
<td align="right">2</td>
<td align="right">-19</td>
<td align="right">-13.0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Sample noodle plot from a single iteration of bootstrapping:</p>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>Distribution of the fraction of collective events in bootstrap
iterations compared to the observed fraction (red dashed line):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tFracActInColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollsel</span><span class="op">)</span></span>
<span><span class="va">tFracActInCollBoot</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tFracActInCollBoot</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fracAct</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">tFracActInColl</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Fraction of activity in collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-11-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the fraction of total (binarised)
activity involved in <strong>observed</strong> collective events is
<strong>greater</strong> than the fraction in randomised events:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="va">tFracActInColl</span>, <span class="va">tFracActInCollBoot</span><span class="op">$</span><span class="va">fracAct</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'greater'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.00990099</span></span></code></pre></div>
<p>Aggregate statistics from bootstrapping.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate the results of bootstrapping per collective event</span></span>
<span><span class="va">tcollbootAggrPerColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcStatsColl.html">calcStatsColl</a></span><span class="op">(</span><span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Further aggregate size &amp; duration per bootstrap iteration</span></span>
<span><span class="va">tcollbootSzDurPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span>,</span>
<span>                                             .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Further aggregate the number of events per bootstrap iteration</span></span>
<span><span class="va">tcollbootNcollPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Distribution of the number of collective events identified in every
bootstrap iteration compared to the observed statistics (red dashed
line):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tcollbootNcollPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-14-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the number of
<strong>observed</strong> clusters is <strong>lower or greater</strong>
than the number of clusters in randomised data:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">tcollbootNcollPerIter</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6336634</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-16-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
cluster duration is <strong>lower or greater</strong> than the cluster
duration in randomised data:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-18-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
total cluster size is <strong>lower or greater</strong> than the cluster
size in randomised data:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="randomly-shift-the-measurement">Randomly shift the measurement<a class="anchor" aria-label="anchor" href="#randomly-shift-the-measurement"></a>
</h3>
<p>Here, entire single-cell tracks are shifted forward or backward in
time. The spatial arrangement of cells and the measurement dynamics are
intact, except activation events occur at different times than
originally.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_randShiftMeas_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu"><a href="../reference/loadDataFromFile.html">loadDataFromFile</a></span><span class="op">(</span>fname <span class="op">=</span> <span class="va">stmp</span>,</span>
<span>                                  colPos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">posx</span>, <span class="va">lCols</span><span class="op">$</span><span class="va">posy</span><span class="op">)</span>,</span>
<span>                                  colFrame <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>,</span>
<span>                                  colIDobj <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span>,</span>
<span>                                  colIDcoll <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span>,</span>
<span>                                  colMeas <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">meas</span>,</span>
<span>                                  colBootIter <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span>,</span>
<span>                                  fromColl <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  fromBoot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackCollBoot.html">trackCollBoot</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                                      nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                                      ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>,</span>
<span>                                      method <span class="op">=</span> <span class="st">'randShiftMeas'</span>, </span>
<span>                                      eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      epsPrev <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      nPrev <span class="op">=</span> <span class="fl">1L</span>, </span>
<span>                                      minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span>,</span>
<span>                                      colldurlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                      colltotszlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>                                      deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#fwrite(tcollselBoot, file = sprintf('../inst/synthetic2D/output-bootstrap-20/bootRes_randShiftMeas_N%d.csv.gz', lPar$nboot))</span></span>
<span><span class="op">}</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="6%">
<col width="5%">
<col width="13%">
<col width="7%">
<col width="4%">
<col width="6%">
<col width="8%">
<col width="5%">
<col width="10%">
<col width="9%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="right">bootiter</th>
<th align="right">frame</th>
<th align="right">id</th>
<th align="right">collid.frame</th>
<th align="right">collid</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">startCE</th>
<th align="right">meas</th>
<th align="right">meas.resc</th>
<th align="right">meas.bin</th>
<th align="right">meas.bin.shuff</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">33</td>
<td align="right">87</td>
<td align="right">1</td>
<td align="right">-9</td>
<td align="right">-19.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">112</td>
<td align="right">87</td>
<td align="right">1</td>
<td align="right">-8</td>
<td align="right">-19.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">760</td>
<td align="right">87</td>
<td align="right">1</td>
<td align="right">-10</td>
<td align="right">-18.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2148</td>
<td align="right">87</td>
<td align="right">1</td>
<td align="right">-9</td>
<td align="right">-18.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">33</td>
<td align="right">88</td>
<td align="right">1</td>
<td align="right">-9</td>
<td align="right">-19.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">112</td>
<td align="right">88</td>
<td align="right">1</td>
<td align="right">-8</td>
<td align="right">-19.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Sample noodle plot from a single iteration of bootstrapping:</p>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-21-1.png" width="768"></p>
<p>Distribution of the fraction of collective events in bootstrap
iterations compared to the observed fraction (red dashed line):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tFracActInColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollsel</span><span class="op">)</span></span>
<span><span class="va">tFracActInCollBoot</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tFracActInCollBoot</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fracAct</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">tFracActInColl</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Fraction of activity in collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-22-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the fraction of total (binarised)
activity involved in <strong>observed</strong> collective events is
<strong>greater</strong> than the fraction in randomised events:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="va">tFracActInColl</span>, <span class="va">tFracActInCollBoot</span><span class="op">$</span><span class="va">fracAct</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'greater'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.00990099</span></span></code></pre></div>
<p>Aggregate statistics from bootstrapping.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate the results of bootstrapping per collective event</span></span>
<span><span class="va">tcollbootAggrPerColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcStatsColl.html">calcStatsColl</a></span><span class="op">(</span><span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Further aggregate size &amp; duration per bootstrap iteration</span></span>
<span><span class="va">tcollbootSzDurPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span>,</span>
<span>                                             .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Further aggregate the number of events per bootstrap iteration</span></span>
<span><span class="va">tcollbootNcollPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Distribution of the number of collective events identified in every
bootstrap iteration compared to the observed statistics (red dashed
line):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tcollbootNcollPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-25-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the number of
<strong>observed</strong> clusters is <strong>lower or greater</strong>
than the number of clusters in randomised data:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">tcollbootNcollPerIter</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-27-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
cluster duration is <strong>lower or greater</strong> than the cluster
duration in randomised data:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-29-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
total cluster size is <strong>lower or greater</strong> than the cluster
size in randomised data:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shuffle-time-points-per-track">Shuffle time points per track<a class="anchor" aria-label="anchor" href="#shuffle-time-points-per-track"></a>
</h3>
<p>Here, individual time points are shuffled independently in each
track. While the spatial arrangement is intact, the measurement dynamics
is completely randomised.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_shuffMeasTrack_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu"><a href="../reference/loadDataFromFile.html">loadDataFromFile</a></span><span class="op">(</span>fname <span class="op">=</span> <span class="va">stmp</span>,</span>
<span>                                  colPos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">posx</span>, <span class="va">lCols</span><span class="op">$</span><span class="va">posy</span><span class="op">)</span>,</span>
<span>                                  colFrame <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>,</span>
<span>                                  colIDobj <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span>,</span>
<span>                                  colIDcoll <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span>,</span>
<span>                                  colMeas <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">meas</span>,</span>
<span>                                  colBootIter <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span>,</span>
<span>                                  fromColl <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  fromBoot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackCollBoot.html">trackCollBoot</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                                      nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                                      ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>,</span>
<span>                                      method <span class="op">=</span> <span class="st">'shuffMeasTrack'</span>, </span>
<span>                                      eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      epsPrev <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      nPrev <span class="op">=</span> <span class="fl">1L</span>, </span>
<span>                                      minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span>,</span>
<span>                                      colldurlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                      colltotszlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>                                      deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#fwrite(tcollselBoot, file = sprintf('../inst/synthetic2D/output-bootstrap-20/bootRes_shuffMeasTrack_N%d.csv.gz', lPar$nboot))</span></span>
<span><span class="op">}</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="6%">
<col width="5%">
<col width="13%">
<col width="7%">
<col width="4%">
<col width="6%">
<col width="8%">
<col width="5%">
<col width="10%">
<col width="9%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="right">bootiter</th>
<th align="right">frame</th>
<th align="right">id</th>
<th align="right">collid.frame</th>
<th align="right">collid</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">startCE</th>
<th align="right">meas</th>
<th align="right">meas.resc</th>
<th align="right">meas.bin</th>
<th align="right">meas.bin.shuff</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">177</td>
<td align="right">196</td>
<td align="right">8</td>
<td align="right">-9</td>
<td align="right">-16.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">759</td>
<td align="right">196</td>
<td align="right">8</td>
<td align="right">-10</td>
<td align="right">-16.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">888</td>
<td align="right">196</td>
<td align="right">8</td>
<td align="right">-9</td>
<td align="right">-15.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1055</td>
<td align="right">199</td>
<td align="right">12</td>
<td align="right">6</td>
<td align="right">-11.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1467</td>
<td align="right">199</td>
<td align="right">12</td>
<td align="right">4</td>
<td align="right">-10.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1569</td>
<td align="right">199</td>
<td align="right">12</td>
<td align="right">6</td>
<td align="right">-10.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Sample noodle plot from a single iteration of bootstrapping:</p>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-32-1.png" width="768"></p>
<p>Distribution of the fraction of collective events in bootstrap
iterations compared to the observed fraction (red dashed line):</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tFracActInColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollsel</span><span class="op">)</span></span>
<span><span class="va">tFracActInCollBoot</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tFracActInCollBoot</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fracAct</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">tFracActInColl</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Fraction of activity in collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-33-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the fraction of total (binarised)
activity involved in <strong>observed</strong> collective events is
<strong>greater</strong> than the fraction in randomised events:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="va">tFracActInColl</span>, <span class="va">tFracActInCollBoot</span><span class="op">$</span><span class="va">fracAct</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'greater'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.00990099</span></span></code></pre></div>
<p>Aggregate statistics from bootstrapping.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate the results of bootstrapping per collective event</span></span>
<span><span class="va">tcollbootAggrPerColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcStatsColl.html">calcStatsColl</a></span><span class="op">(</span><span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Further aggregate size &amp; duration per bootstrap iteration</span></span>
<span><span class="va">tcollbootSzDurPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span>,</span>
<span>                                             .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Further aggregate the number of events per bootstrap iteration</span></span>
<span><span class="va">tcollbootNcollPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Distribution of the number of collective events identified in every
bootstrap iteration compared to the observed statistics (red dashed
line):</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tcollbootNcollPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-36-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the number of
<strong>observed</strong> clusters is <strong>lower or greater</strong>
than the number of clusters in randomised data:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">tcollbootNcollPerIter</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-38-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
cluster duration is <strong>lower or greater</strong> than the cluster
duration in randomised data:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-40-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
total cluster size is <strong>lower or greater</strong> than the cluster
size in randomised data:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shuffle-measurement-per-frame">Shuffle measurement per frame<a class="anchor" aria-label="anchor" href="#shuffle-measurement-per-frame"></a>
</h3>
<p>Here, binarised measurements are shuffled between cells independently
in every time frame.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_shuffMeasFrame_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu"><a href="../reference/loadDataFromFile.html">loadDataFromFile</a></span><span class="op">(</span>fname <span class="op">=</span> <span class="va">stmp</span>,</span>
<span>                                  colPos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">posx</span>, <span class="va">lCols</span><span class="op">$</span><span class="va">posy</span><span class="op">)</span>,</span>
<span>                                  colFrame <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>,</span>
<span>                                  colIDobj <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span>,</span>
<span>                                  colIDcoll <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span>,</span>
<span>                                  colMeas <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">meas</span>,</span>
<span>                                  colBootIter <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span>,</span>
<span>                                  fromColl <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  fromBoot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackCollBoot.html">trackCollBoot</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                                      nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                                      ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>,</span>
<span>                                      method <span class="op">=</span> <span class="st">'shuffMeasFrame'</span>, </span>
<span>                                      eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      epsPrev <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      nPrev <span class="op">=</span> <span class="fl">1L</span>, </span>
<span>                                      minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span>,</span>
<span>                                      colldurlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                      colltotszlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>                                      deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#fwrite(tcollselBoot, file = sprintf('../inst/synthetic2D/output-bootstrap-20/bootRes_shuffMeasFrame_N%d.csv.gz', lPar$nboot))</span></span>
<span><span class="op">}</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="6%">
<col width="5%">
<col width="13%">
<col width="7%">
<col width="3%">
<col width="6%">
<col width="8%">
<col width="5%">
<col width="10%">
<col width="9%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="right">bootiter</th>
<th align="right">frame</th>
<th align="right">id</th>
<th align="right">collid.frame</th>
<th align="right">collid</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">startCE</th>
<th align="right">meas</th>
<th align="right">meas.resc</th>
<th align="right">meas.bin</th>
<th align="right">meas.bin.shuff</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">54</td>
<td align="right">4</td>
<td align="right">13</td>
<td align="right">44</td>
<td align="right">6</td>
<td align="right">-15.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">54</td>
<td align="right">108</td>
<td align="right">13</td>
<td align="right">44</td>
<td align="right">7</td>
<td align="right">-16.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">54</td>
<td align="right">675</td>
<td align="right">13</td>
<td align="right">44</td>
<td align="right">5</td>
<td align="right">-15.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">54</td>
<td align="right">1500</td>
<td align="right">13</td>
<td align="right">44</td>
<td align="right">5</td>
<td align="right">-16.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">55</td>
<td align="right">1500</td>
<td align="right">156</td>
<td align="right">44</td>
<td align="right">5</td>
<td align="right">-16.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">55</td>
<td align="right">1683</td>
<td align="right">156</td>
<td align="right">44</td>
<td align="right">7</td>
<td align="right">-17.0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Sample noodle plot from a single iteration of bootstrapping:</p>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-43-1.png" width="768"></p>
<p>Distribution of the fraction of collective events in bootstrap
iterations compared to the observed fraction (red dashed line):</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tFracActInColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollsel</span><span class="op">)</span></span>
<span><span class="va">tFracActInCollBoot</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tFracActInCollBoot</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fracAct</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">tFracActInColl</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Fraction of activity in collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-44-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the fraction of total (binarised)
activity involved in <strong>observed</strong> collective events is
<strong>greater</strong> than the fraction in randomised events:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="va">tFracActInColl</span>, <span class="va">tFracActInCollBoot</span><span class="op">$</span><span class="va">fracAct</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'greater'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.00990099</span></span></code></pre></div>
<p>Aggregate statistics from bootstrapping.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate the results of bootstrapping per collective event</span></span>
<span><span class="va">tcollbootAggrPerColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcStatsColl.html">calcStatsColl</a></span><span class="op">(</span><span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Further aggregate size &amp; duration per bootstrap iteration</span></span>
<span><span class="va">tcollbootSzDurPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span>,</span>
<span>                                             .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Further aggregate the number of events per bootstrap iteration</span></span>
<span><span class="va">tcollbootNcollPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Distribution of the number of collective events identified in every
bootstrap iteration compared to the observed statistics (red dashed
line):</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tcollbootNcollPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-47-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the number of
<strong>observed</strong> clusters is <strong>lower or greater</strong>
than the number of clusters in randomised data:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">tcollbootNcollPerIter</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-49-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
cluster duration is <strong>lower or greater</strong> than the cluster
duration in randomised data:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-51-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
total cluster size is <strong>lower or greater</strong> than the cluster
size in randomised data:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shuffle-blocks-per-track">Shuffle blocks per track<a class="anchor" aria-label="anchor" href="#shuffle-blocks-per-track"></a>
</h3>
<p>In this approach, blocks of activity in binarised time series are
shuffled independently in every track.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">stmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'synthetic2D/output-bootstrap-20/bootRes_shuffBlockTrack_N%d.csv.gz'</span>, <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>                   package <span class="op">=</span> <span class="st">'ARCOS'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">stmp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu"><a href="../reference/loadDataFromFile.html">loadDataFromFile</a></span><span class="op">(</span>fname <span class="op">=</span> <span class="va">stmp</span>,</span>
<span>                                  colPos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">posx</span>, <span class="va">lCols</span><span class="op">$</span><span class="va">posy</span><span class="op">)</span>,</span>
<span>                                  colFrame <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">frame</span>,</span>
<span>                                  colIDobj <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">trackid</span>,</span>
<span>                                  colIDcoll <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span>,</span>
<span>                                  colMeas <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">meas</span>,</span>
<span>                                  colBootIter <span class="op">=</span> <span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span>,</span>
<span>                                  fromColl <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  fromBoot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tcollselBoot</span> <span class="op">=</span> <span class="fu">ARCOS</span><span class="fu">::</span><span class="fu"><a href="../reference/trackCollBoot.html">trackCollBoot</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">ts</span>, </span>
<span>                                      nboot <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">nboot</span>, </span>
<span>                                      ncores <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">ncores</span>, </span>
<span>                                      method <span class="op">=</span> <span class="st">'shuffBlockTrack'</span>, </span>
<span>                                      eps <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      epsPrev <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.eps</span>, </span>
<span>                                      nPrev <span class="op">=</span> <span class="fl">1L</span>, </span>
<span>                                      minClSz <span class="op">=</span> <span class="va">lPar</span><span class="op">$</span><span class="va">db.minPts</span>,</span>
<span>                                      colldurlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mindur</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                      colltotszlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lPar</span><span class="op">$</span><span class="va">coll.mintotsz</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>                                      deb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#fwrite(tcollselBoot, file = sprintf('../inst/synthetic2D/output-bootstrap-20/bootRes_shuffBlockTrack_N$d.csv.gz', lPar$nboot))</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="6%">
<col width="3%">
<col width="13%">
<col width="7%">
<col width="4%">
<col width="6%">
<col width="8%">
<col width="5%">
<col width="10%">
<col width="9%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="right">bootiter</th>
<th align="right">frame</th>
<th align="right">id</th>
<th align="right">collid.frame</th>
<th align="right">collid</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">startCE</th>
<th align="right">meas</th>
<th align="right">meas.resc</th>
<th align="right">meas.bin</th>
<th align="right">meas.bin.shuff</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">12</td>
<td align="right">324</td>
<td align="right">1</td>
<td align="right">-18</td>
<td align="right">12.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">14</td>
<td align="right">325</td>
<td align="right">2</td>
<td align="right">-4</td>
<td align="right">1.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">15</td>
<td align="right">326</td>
<td align="right">3</td>
<td align="right">14</td>
<td align="right">13.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">23</td>
<td align="right">327</td>
<td align="right">4</td>
<td align="right">-9</td>
<td align="right">-12.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="right">324</td>
<td align="right">1</td>
<td align="right">-17</td>
<td align="right">15.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">25</td>
<td align="right">347</td>
<td align="right">5</td>
<td align="right">-9</td>
<td align="right">15.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Sample noodle plot from a single iteration of bootstrapping:</p>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-54-1.png" width="768"></p>
<p>Distribution of the fraction of collective events in bootstrap
iterations compared to the observed fraction (red dashed line):</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tFracActInColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollsel</span><span class="op">)</span></span>
<span><span class="va">tFracActInCollBoot</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcFracActInColl.html">calcFracActInColl</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tFracActInCollBoot</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fracAct</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">tFracActInColl</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Fraction of activity in collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-55-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the fraction of total (binarised)
activity involved in <strong>observed</strong> collective events is
<strong>greater</strong> than the fraction in randomised events:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="va">tFracActInColl</span>, <span class="va">tFracActInCollBoot</span><span class="op">$</span><span class="va">fracAct</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'greater'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.00990099</span></span></code></pre></div>
<p>Aggregate statistics from bootstrapping.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate the results of bootstrapping per collective event</span></span>
<span><span class="va">tcollbootAggrPerColl</span> <span class="op">=</span> <span class="fu"><a href="../reference/calcStatsColl.html">calcStatsColl</a></span><span class="op">(</span><span class="va">tcollselBoot</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Further aggregate size &amp; duration per bootstrap iteration</span></span>
<span><span class="va">tcollbootSzDurPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span>,</span>
<span>                                             .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'clDur'</span>, <span class="st">'totSz'</span>, <span class="st">'minSz'</span>, <span class="st">'maxSz'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Further aggregate the number of events per bootstrap iteration</span></span>
<span><span class="va">tcollbootNcollPerIter</span> <span class="op">=</span> <span class="va">tcollbootAggrPerColl</span><span class="op">[</span>,</span>
<span>                                             <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">cltrackid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCols</span><span class="op">$</span><span class="va">bootiter</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Distribution of the number of collective events identified in every
bootstrap iteration compared to the observed statistics (red dashed
line):</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tcollbootNcollPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"lightblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Number of collective events'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_clean.html" class="external-link">theme_clean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-58-1.png" width="480"></p>
<p>P-value, alternative hypothesis - the number of
<strong>observed</strong> clusters is <strong>lower or greater</strong>
than the number of clusters in randomised data:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">)</span>, <span class="va">tcollbootNcollPerIter</span><span class="op">$</span><span class="va">N</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> cluster duration from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
cluster duration from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clDur</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Duration of collective events [#frames]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-60-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
cluster duration is <strong>lower or greater</strong> than the cluster
duration in randomised data:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">clDur</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">clDur</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
<p>Distribution of the <strong>mean</strong> total cluster size from
bootstrap iterations (solid black line) vs. the <strong>mean</strong>
total cluster size from the non-bootstrapped data (red dashed line):</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tcollbootSzDurPerIter</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">totSz</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"#cells involved in collective events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ARCOS-bootstrapping_files/figure-html/unnamed-chunk-62-1.png" width="480"></p>
<p>P-value, alternative hypothesis - mean <strong>observed</strong>
total cluster size is <strong>lower or greater</strong> than the cluster
size in randomised data:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcPvalFromBS.html">calcPvalFromBS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tcollselAggr</span><span class="op">$</span><span class="va">totSz</span><span class="op">)</span>, <span class="va">tcollbootSzDurPerIter</span><span class="op">$</span><span class="va">totSz</span>, corrected <span class="op">=</span> <span class="cn">T</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01980198</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maciej Dobrzyński.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
